<!DOCTYPE html>
<html>
<head>
    <title>Eating Habits of Kenyans</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map {
            height: 600px;
            width: 100%;
        }
    </style>
</head>
<body>
    <h1>Eating Habits of Kenyans</h1>
    <div id="map"></div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <!-- Leaflet DVF (Data Visualization Framework) -->
    <script src="https://unpkg.com/leaflet-dvf/dist/leaflet-dvf.min.js"></script>
    <script>
        // Initialize the map and set its view to Kenya's coordinates and zoom level
        var map = L.map('map').setView([-1.286389, 36.817223], 7);

        // Add a tile layer to the map (OpenStreetMap tiles)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Example data of eating habits
        var eatingHabits = [
            { location: [ -1.286389, 36.817223 ], city: 'Nairobi', vegetarian: 30, nonVegetarian: 70 },
            { location: [ -0.091702, 34.767956 ], city: 'Kisumu', vegetarian: 20, nonVegetarian: 80 },
            { location: [ -0.463500, 39.646011 ], city: 'Mombasa', vegetarian: 25, nonVegetarian: 75 },
            { location: [ 0.516667, 35.283333 ], city: 'Eldoret', vegetarian: 40, nonVegetarian: 60 },
            { location: [ 0.456034, 36.960562 ], city: 'Nyeri', vegetarian: 35, nonVegetarian: 65 }
        ];

        // Add pie chart markers to the map
        eatingHabits.forEach(function(habit) {
            var pieChartMarker = new L.PieChartMarker(habit.location, {
                radius: 25,
                data: {
                    'Vegetarian': habit.vegetarian,
                    'Non-Vegetarian': habit.nonVegetarian
                },
                chartOptions: {
                    'Vegetarian': {
                        fillColor: '#00ff00', // Green
                        minValue: 0,
                        maxValue: 100,
                        displayText: function(value) {
                            return value.toFixed(1) + '%';
                        }
                    },
                    'Non-Vegetarian': {
                        fillColor: '#ff0000', // Red
                        minValue: 0,
                        maxValue: 100,
                        displayText: function(value) {
                            return value.toFixed(1) + '%';
                        }
                    }
                },
                weight: 1,
                color: '#000000',
                opacity: 1,
                fillOpacity: 0.8,
                text: habit.city
            });

            pieChartMarker.bindPopup('<b>' + habit.city + '</b><br>Vegetarian: ' + habit.vegetarian + '%<br>Non-Vegetarian: ' + habit.nonVegetarian + '%');
            pieChartMarker.addTo(map);
        });
    </script>
</body>
</html>
